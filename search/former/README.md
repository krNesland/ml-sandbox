TODOs:
- Use numpy where possible
